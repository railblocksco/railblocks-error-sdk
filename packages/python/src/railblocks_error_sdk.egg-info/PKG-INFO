Metadata-Version: 2.4
Name: railblocks-error-sdk
Version: 0.0.3
Summary: Python error reporting SDK using Trigger.dev HTTP API
Author-email: Railblocks <team@railblocks.co>
License: MIT
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Requires-Python: >=3.8
Description-Content-Type: text/markdown
Requires-Dist: aiohttp>=3.8.0

# railblocks-error-sdk

Python error reporting SDK using Trigger.dev HTTP API.

## Installation

This is a git submodule. Add it to your project:

```bash
# Add the submodule to your project
git submodule add https://github.com/railblocksco/railblocks-error-sdk.git
```

### Updating the Submodule

To get the latest version of the SDK:

```bash
# Update to the latest commit
git submodule update --remote railblocks-error-sdk
```

## Quick Start

### Local Development
```python
import asyncio
from railblocks_error_sdk import create_error_client, ErrorReportingOptions

async def main():
    client = create_error_client(ErrorReportingOptions(environment='production'))
    
    # Report service error (AI classification)
    await client.report_service_error(
        'acme-corp',
        'payment',
        'Payment method declined',
        {'user_id': 'user_123'}
    )
    
    # Report known error code
    await client.report_known_error(
        'acme-corp',
        'STRIPE-001',
        'Payment failed'
    )

asyncio.run(main())
```

### Modal Integration

To use this SDK in Modal, add it to your Modal image:

```python
from modal import Image, App

# Define path to the SDK
SDK_PATH = "lib/railblocks-error-sdk"

image = (
    Image.debian_slim(python_version="3.12")
    .pip_install_from_requirements("requirements.txt")
    .add_local_dir(SDK_PATH, "/tmp/sdk", copy=True)
    .run_commands("pip install -e /tmp/sdk/packages/python")
)

app = App("my-app", image=image)

@app.function()
def my_function():
    from railblocks_error_sdk import create_error_client, ErrorReportingOptions
    
    client = create_error_client(ErrorReportingOptions(environment='production'))
    # Use the client...
```

## Environment Setup

```bash
export TRIGGER_SECRET_KEY=tr_dev_your_api_key
```

## Quick Reference

### Adding to a New Project
```bash
git submodule add https://github.com/railblocksco/railblocks-error-sdk.git
git submodule update --init --recursive
```

### Updating in Existing Project
```bash
git submodule update --remote railblocks-error-sdk
git add railblocks-error-sdk
git commit -m "Update SDK"
```

### Import in Your Code
```python
from railblocks_error_sdk import create_error_client, ErrorReportingOptions
```

## API

### `create_error_client(options?)`

**Options:**
- `options`: `ErrorReportingOptions` object with:
  - `api_key`: Trigger.dev API key (defaults to `TRIGGER_SECRET_KEY`)
  - `task_id`: Task ID (defaults to `'ingest-error'`)
  - `environment`: 'development' | 'staging' | 'production'
  - `max_retries`: number (default: 3)
  - `retry_delay`: number in ms (default: 1000)
  - `timeout`: number in ms (default: 10000)
  - `default_context`: dict

### Methods

```python
# Report service error (AI classification)
client.report_service_error(company_code, service, message, context?)

# Report known error code
client.report_known_error(company_code, error_code, message, context?)

# Report with full payload
client.report_error(payload: IngestErrorPayload)
```

## Development

Since this is a git submodule, you can work on the SDK directly:

```bash
# Navigate to the Python package
cd railblocks-error-sdk/packages/python

# Install in editable mode
pip install -e .

# Test the SDK
python3 test_client.py
```

### Local Setup for Modal Development

To test the SDK locally before deploying to Modal:

```bash
# Install the SDK in your local environment
cd lib/railblocks-error-sdk/packages/python
pip install -e .

# Test imports
python -c "from railblocks_error_sdk import create_error_client; print('SDK ready!')"
```

## License

MIT 
